{"version":3,"file":"createTargetFactory.js","sourceRoot":"","sources":["../../src/decorators/createTargetFactory.ts"],"names":[],"mappings":"AAIA,OAAO,EAAE,SAAS,EAAE,MAAM,sBAAsB,CAAA;AAEhD,OAAO,EAAE,aAAa,EAAE,MAAM,mBAAmB,CAAA;AAEjD,OAAO,EAAE,qBAAqB,EAAE,MAAM,SAAS,CAAA;AAC/C,MAAM,oBAAoB,GAAG,CAAC,SAAS,EAAE,OAAO,EAAE,MAAM,CAAC,CAAA;AAOzD,MAAM,UAAU;IAMf,YACC,IAA2B,EAC3B,OAA0B,EAC1B,GAAmB;QARZ,UAAK,GAAiB,IAAI,CAAA;QAUjC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;QACtB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAA;IACf,CAAC;IAEM,YAAY,CAAC,KAAY;QAC/B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;IACnB,CAAC;IAEM,cAAc,CAAC,OAA0B;QAC/C,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;IACvB,CAAC;IAEM,OAAO;QACb,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACvB,OAAO,IAAI,CAAA;SACX;QAED,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAc,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;IAC5D,CAAC;IAEM,KAAK;QACX,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACpC,OAAM;SACN;QACD,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,EAAE,qBAAqB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAA;IAC3E,CAAC;IAEM,IAAI;QACV,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACpB,OAAO,SAAS,CAAA;SAChB;QAED,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAChC,IAAI,CAAC,KAAc,EACnB,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,GAAG,CAAC,OAAO,CAChB,CAAA;QACD,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;YAC1C,SAAS,CACR,OAAO,UAAU,KAAK,WAAW,IAAI,aAAa,CAAC,UAAU,CAAC,EAC9D,qFAAqF;gBACpF,uBAAuB;gBACvB,sEAAsE,EACvE,UAAU,CACV,CAAA;SACD;QACD,OAAO,UAAU,CAAA;IAClB,CAAC;CACD;AAED,MAAM,UAAU,mBAAmB,CAAQ,IAA2B;IACrE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;QACjC,SAAS,CACR,oBAAoB,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EACtC,sDAAsD;YACrD,kCAAkC;YAClC,gEAAgE;YAChE,sEAAsE,EACvE,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,EAC/B,GAAG,CACH,CAAA;QACD,SAAS,CACR,OAAQ,IAAY,CAAC,GAAG,CAAC,KAAK,UAAU,EACxC,iEAAiE;YAChE,gDAAgD;YAChD,sEAAsE,EACvE,GAAG,EACH,GAAG,EACF,IAAY,CAAC,GAAG,CAAC,CAClB,CAAA;IACF,CAAC,CAAC,CAAA;IAEF,OAAO,SAAS,YAAY,CAC3B,OAA0B,EAC1B,GAAmB;QAEnB,OAAO,IAAI,UAAU,CAAC,IAAI,EAAE,OAAO,EAAE,GAAG,CAAC,CAAA;IAC1C,CAAC,CAAA;AACF,CAAC","sourcesContent":["declare const process: any\n\nimport { RefObject } from 'react'\nimport { DropTarget } from 'dnd-core'\nimport { invariant } from '@react-dnd/invariant'\nimport { DropTargetMonitor } from '../interfaces'\nimport { isPlainObject } from '../utils/js_utils'\nimport { DropTargetSpec } from './interfaces'\nimport { getDecoratedComponent } from './utils'\nconst ALLOWED_SPEC_METHODS = ['canDrop', 'hover', 'drop']\n\nexport interface Target extends DropTarget {\n\treceiveProps(props: any): void\n\treceiveMonitor(monitor: any): void\n}\n\nclass TargetImpl<Props> implements Target {\n\tprivate props: Props | null = null\n\tprivate spec: DropTargetSpec<Props>\n\tprivate monitor: DropTargetMonitor\n\tprivate ref: RefObject<any>\n\n\tpublic constructor(\n\t\tspec: DropTargetSpec<Props>,\n\t\tmonitor: DropTargetMonitor,\n\t\tref: RefObject<any>,\n\t) {\n\t\tthis.spec = spec\n\t\tthis.monitor = monitor\n\t\tthis.ref = ref\n\t}\n\n\tpublic receiveProps(props: Props) {\n\t\tthis.props = props\n\t}\n\n\tpublic receiveMonitor(monitor: DropTargetMonitor) {\n\t\tthis.monitor = monitor\n\t}\n\n\tpublic canDrop(): boolean {\n\t\tif (!this.spec.canDrop) {\n\t\t\treturn true\n\t\t}\n\n\t\treturn this.spec.canDrop(this.props as Props, this.monitor)\n\t}\n\n\tpublic hover() {\n\t\tif (!this.spec.hover || !this.props) {\n\t\t\treturn\n\t\t}\n\t\tthis.spec.hover(this.props, this.monitor, getDecoratedComponent(this.ref))\n\t}\n\n\tpublic drop() {\n\t\tif (!this.spec.drop) {\n\t\t\treturn undefined\n\t\t}\n\n\t\tconst dropResult = this.spec.drop(\n\t\t\tthis.props as Props,\n\t\t\tthis.monitor,\n\t\t\tthis.ref.current,\n\t\t)\n\t\tif (process.env.NODE_ENV !== 'production') {\n\t\t\tinvariant(\n\t\t\t\ttypeof dropResult === 'undefined' || isPlainObject(dropResult),\n\t\t\t\t'drop() must either return undefined, or an object that represents the drop result. ' +\n\t\t\t\t\t'Instead received %s. ' +\n\t\t\t\t\t'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',\n\t\t\t\tdropResult,\n\t\t\t)\n\t\t}\n\t\treturn dropResult\n\t}\n}\n\nexport function createTargetFactory<Props>(spec: DropTargetSpec<Props>) {\n\tObject.keys(spec).forEach((key) => {\n\t\tinvariant(\n\t\t\tALLOWED_SPEC_METHODS.indexOf(key) > -1,\n\t\t\t'Expected the drop target specification to only have ' +\n\t\t\t\t'some of the following keys: %s. ' +\n\t\t\t\t'Instead received a specification with an unexpected \"%s\" key. ' +\n\t\t\t\t'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',\n\t\t\tALLOWED_SPEC_METHODS.join(', '),\n\t\t\tkey,\n\t\t)\n\t\tinvariant(\n\t\t\ttypeof (spec as any)[key] === 'function',\n\t\t\t'Expected %s in the drop target specification to be a function. ' +\n\t\t\t\t'Instead received a specification with %s: %s. ' +\n\t\t\t\t'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',\n\t\t\tkey,\n\t\t\tkey,\n\t\t\t(spec as any)[key],\n\t\t)\n\t})\n\n\treturn function createTarget(\n\t\tmonitor: DropTargetMonitor,\n\t\tref: RefObject<any>,\n\t): Target {\n\t\treturn new TargetImpl(spec, monitor, ref)\n\t}\n}\n"]}